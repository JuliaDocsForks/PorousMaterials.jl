<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Functions · PorousMaterials.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>PorousMaterials.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">Home</a></li><li class="current"><a class="toctext" href="functions.html">Functions</a><ul class="internal"></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href="functions.html">Functions</a></li></ul><a class="edit-page" href="https://github.com/ahyork/PorousMaterials.jl/blob/master/docs/src/functions.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Functions</span><a class="fa fa-bars" href="#"></a></div></header><p>#Functions This page contains all of the functions exported by PorousMaterials. They are sorted by the .jl files they are found in.</p><p>##Box.jl</p><pre><code class="language-none">    Box
    replicate
    UnitCube</code></pre><p>##Crystal.jl</p><pre><code class="language-none">    Framework
    read_crystal_structure_file
    remove_overlapping_atoms
    strip_numbers_from_atom_labels!
    write_unitcell_boundary_vtk
    chemical_formula
    molecular_weight
    crystal_density
    construct_box
    replicate
    read_atomic_masses
    charged(::Framework, ::Bool)
    write_cif
    assign_charges</code></pre><p>##ElectrostaticsEnergetics.jl</p><pre><code class="language-none">    electrostatic_potential
    electrostatic_potential_energy
    precompute_kvec_wts
    setup_Ewald_sum
    total</code></pre><p>##Energetics_Util.jl</p><pre><code class="language-none">    PotentialEnergy
    SystemPotentialEnergy</code></pre><p>##EOS.jl</p><pre><code class="language-none">    PengRobinsonsGas
    calculate_properties</code></pre><p>##Forcefield.jl</p><pre><code class="language-none">    LJForcefield
    replication_factors
    check_forcefield_coverage</code></pre><p>##GCMC.jl</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PorousMaterials.gcmc_simulation" href="#PorousMaterials.gcmc_simulation"><code>PorousMaterials.gcmc_simulation</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">results, molecules = gcmc_simulation(framework, molecule, temperature, pressure,
                                     ljforcefield; n_sample_cycles=5000,
                                     n_burn_cycles=5000, sample_frequency=5,
                                     verbose=false, molecules=Molecule[],
                                     eos=:ideal)</code></pre><p>Runs a grand-canonical (μVT) Monte Carlo simulation of the adsorption of a molecule in a framework at a particular temperature and pressure using a Lennard Jones force field.</p><p>A cycle is defined as max(20, number of adsorbates currently in the system) Markov chain proposals. Current Markov chain moves implemented are particle insertion/deletion and translation.</p><p><strong>Arguments</strong></p><ul><li><p><code>framework::Framework</code>: the porous crystal in which we seek to simulate adsorption</p></li><li><p><code>temperature::Float64</code>: temperature of bulk gas phase in equilibrium with adsorbed phase   in the porous material. units: Kelvin (K)</p></li><li><p><code>pressure::Float64</code>: pressure of bulk gas phase in equilibrium with adsorbed phase in the   porous material. units: bar</p></li><li><p><code>molecule::Molecule</code>: a template of the adsorbate molecule of which we seek to simulate   the adsorption</p></li><li><p><code>ljforcefield::LJForceField</code>: the molecular model used to describe the   energetics of the adsorbate-adsorbate and adsorbate-host van der Waals interactions.</p></li><li><p><code>n_burn_cycles::Int</code>: number of cycles to allow the system to reach equilibrium before   sampling.</p></li><li><p><code>n_sample_cycles::Int</code>: number of cycles used for sampling</p></li><li><p><code>sample_frequency::Int</code>: during the sampling cycles, sample e.g. the number of adsorbed   gas molecules every this number of Markov proposals.</p></li><li><p><code>verbose::Bool</code>: whether or not to print off information during the simulation.</p></li><li><p><code>molecules::Array{Molecule, 1}</code>: a starting configuration of molecules in the framework.</p></li></ul><p>Note that we assume these coordinates are Cartesian, i.e. corresponding to a unit box.</p><ul><li><p><code>eos::Symbol</code>: equation of state to use for calculation of fugacity from pressure. Default</p></li></ul><p>is ideal gas, where fugacity = pressure.</p></div><a class="source-link" target="_blank" href="https://github.com/ahyork/PorousMaterials.jl/blob/edd63400959661cc89ea934fcf927e89007066a7/src/GCMC.jl#L198-L233">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PorousMaterials.adsorption_isotherm" href="#PorousMaterials.adsorption_isotherm"><code>PorousMaterials.adsorption_isotherm</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">results = adsorption_isotherm(framework, molecule, temperature, pressures,
                              ljforcefield; n_sample_cycles=100000,
                              n_burn_cycles=10000, sample_frequency=25,
                              verbose=false, molecules=Molecule[],
                              ewald_precision=1e-6, eos=:ideal)</code></pre><p>Run a set of grand-canonical (μVT) Monte Carlo simulations in parallel. Arguments are the same as <a href="functions.html#PorousMaterials.gcmc_simulation"><code>gcmc_simulation</code></a>, as this is the function run in parallel behind the scenes. The only exception is that we pass an array of pressures. To give Julia access to multiple cores, run your script as <code>julia -p 4 mysim.jl</code> to allocate e.g. four cores. See <a href="https://docs.julialang.org/en/stable/manual/parallel-computing/#Parallel-Computing-1">Parallel Computing</a>.</p></div><a class="source-link" target="_blank" href="https://github.com/ahyork/PorousMaterials.jl/blob/edd63400959661cc89ea934fcf927e89007066a7/src/GCMC.jl#L159-L171">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PorousMaterials.stepwise_adsorption_isotherm" href="#PorousMaterials.stepwise_adsorption_isotherm"><code>PorousMaterials.stepwise_adsorption_isotherm</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">results = stepwise_adsorption_isotherm(framework, molecule, temperature, pressures,
                              ljforcefield; n_sample_cycles=100000,
                              n_burn_cycles=10000, sample_frequency=10,
                              verbose=true, molecules=Molecule[],
                              ewald_precision=1e-6, eos=:ideal)</code></pre><p>Run a set of grand-canonical (μVT) Monte Carlo simulations in series. Arguments are the same as <a href="functions.html#PorousMaterials.gcmc_simulation"><code>gcmc_simulation</code></a>, as this is the function run behind the scenes. An exception is that we pass an array of pressures. The adsorption isotherm is computed step- wise, where the ending configuration from the previous simulation (array of molecules) is passed into the next simulation as a starting point. The ordering of <code>pressures</code> is honored. By giving each simulation a good starting point, (if the next pressure does not differ significantly from the previous pressure), we can reduce the number of burn cycles required to reach equilibrium in the Monte Carlo simulation. Also see <a href="functions.html#PorousMaterials.adsorption_isotherm"><code>adsorption_isotherm</code></a> which runs the μVT simulation at each pressure in parallel.</p></div><a class="source-link" target="_blank" href="https://github.com/ahyork/PorousMaterials.jl/blob/edd63400959661cc89ea934fcf927e89007066a7/src/GCMC.jl#L121-L137">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PorousMaterials.gcmc_result_savename" href="#PorousMaterials.gcmc_result_savename"><code>PorousMaterials.gcmc_result_savename</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">file_save_name = gcmc_result_savename(framework_name, molecule_species
                                    ljforcefield_name, temperature, pressure,
                                    n_burn_cycles, n_sample_cycles)</code></pre><p>Determine the name of files saved during the GCMC simulation, be molecule positions or results. It uses many pieces of information from the simulation to ensure the file name accurately describes what it holds.</p><p><strong>Arguments</strong></p><ul><li><p><code>framework_name::AbstractString</code>: The porous crystal being tested</p></li><li><p><code>molecule_species::Symbol</code>: The molecule being tested inside the porous crystal</p></li><li><p><code>ljforcefield_name::AbstractString</code>: The molecular model being used in this   simulation to describe intermolecular Van der Waals interactions</p></li><li><p><code>temperature::Float64</code>: The temperature used in the simulation units: Kelvin (K)</p></li><li><p><code>pressure::Float64</code>: The pressure used in the simulation units: bar</p></li><li><p><code>n_burn_cycles::Int</code>: The number of burn cycles used in this simulation</p></li><li><p><code>n_sample_cycles::Int</code>: The number of sample cycles used in this simulation</p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/ahyork/PorousMaterials.jl/blob/edd63400959661cc89ea934fcf927e89007066a7/src/GCMC.jl#L656-L674">source</a></section><p>##Grid.jl</p><pre><code class="language-none">    Grid
    apply_periodic_boundary_condition
    write_cube
    read_cube
    energy_grid</code></pre><p>##Henry.jl</p><pre><code class="language-none">    henry_coefficient
    henry_result_savename</code></pre><p>##Matter.jl</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PorousMaterials.LJSphere" href="#PorousMaterials.LJSphere"><code>PorousMaterials.LJSphere</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Data structure for a Lennard-Jones sphere, containing its species and position in  fractional coordinates.</p><p><strong>Example use</strong></p><pre><code class="language-none">ljs = LJSphere(:C, [0.0, 0.0, 0.0])</code></pre><p><strong>Attributes</strong></p><ul><li><p><code>species::Symbol</code>: atom species name, e.g. <code>:C</code></p></li><li><p><code>xf::Array{Float64, 1}</code>: fractional coordinates, e.g. <code>[1.0, 0.0, 4.0]</code>.</p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/ahyork/PorousMaterials.jl/blob/edd63400959661cc89ea934fcf927e89007066a7/src/Matter.jl#L3-L13">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PorousMaterials.PtCharge" href="#PorousMaterials.PtCharge"><code>PorousMaterials.PtCharge</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Point charge data structure indicates its charge and position in fractional coordinates.</p><p><strong>Example use</strong></p><pre><code class="language-none">ptc = PtCharge(-0.2, [0.0, 0.0, 0.0])</code></pre><p><strong>Attributes</strong></p><ul><li><p><code>q::Float64</code>: signed magnitude of charge (units: electrons), e.g. <code>1.0</code></p></li><li><p><code>xf::Array{Float64, 1}</code>: fractional coordinates, e.g. <code>[1.0, 0.0, 4.0]</code>.</p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/ahyork/PorousMaterials.jl/blob/edd63400959661cc89ea934fcf927e89007066a7/src/Matter.jl#L23-L32">source</a></section><p>##MChelpers.jl</p><pre><code class="language-none">    insert_molecule!
    delete_molecule!
    translate_molecule!
    reinsert_molecule!
    rotatable</code></pre><p>##Misc.jl</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PorousMaterials.read_xyz" href="#PorousMaterials.read_xyz"><code>PorousMaterials.read_xyz</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">atoms, x = read_xyz(filename)</code></pre><p>Return the list of <code>atoms</code> (Array{Symbol, 1}) and their Cartesian coordinates <code>x::Array{Float64, 2}</code> as stored in the .xyz file. <code>x[:, k]</code> will return Cartesian coords of the kth atom.</p><p><strong>Arguments</strong></p><ul><li><p><code>filename::AbstractString</code>: The filename of the .xyz file</p></li></ul><p><strong>Returns</strong></p><ul><li><p><code>atoms::Array{Symbol, 1}</code>: An array of atoms stored as symbols e.g. [:H, :H, :O] read</p></li></ul><p>from the .xyz file.</p><ul><li><p><code>x::Array{Float64, 2}</code>: The Cartesian coordinates of the atoms. <code>x[:, k]</code> will return cartesian coordinates of the k-th atom</p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/ahyork/PorousMaterials.jl/blob/edd63400959661cc89ea934fcf927e89007066a7/src/Misc.jl#L1-L15">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PorousMaterials.read_cpk_colors" href="#PorousMaterials.read_cpk_colors"><code>PorousMaterials.read_cpk_colors</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">atom_colors = read_cpk_colors()</code></pre><p>Read in CPK color scheme for atoms. Return <code>atom_colors::Dict{Symbol, Tuple{Int, Int, Int}}</code> such that <code>atom_colors[&quot;:C&quot;]</code> gives RGB code for carbon as a tuple, <code>(144, 144, 144)</code>. https://en.wikipedia.org/wiki/CPK_coloring</p><p><strong>Returns</strong></p><ul><li><p><code>atom_colors::Dict{Symbol, Tuple{Int, Int, Int}}</code>: A dictionary linking an element symbol to its&#39; corresponding CPK color in RGB</p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/ahyork/PorousMaterials.jl/blob/edd63400959661cc89ea934fcf927e89007066a7/src/Misc.jl#L68-L77">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PorousMaterials.read_atomic_radii" href="#PorousMaterials.read_atomic_radii"><code>PorousMaterials.read_atomic_radii</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">atomic_radii = read_atomic_radii()</code></pre><p>Return <code>atomic_radii::Dict{Symbol, Float64}</code>, where <code>atom_masses[&quot;:C&quot;]</code> gives the atomic radii of carbon (10.87 Angstrom).</p><p><strong>Returns</strong></p><ul><li><p><code>atomic_radii::Dict{Symbol, Float64}</code>: A dictionary linking an element symbol to its&#39; corresponding atomic radius</p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/ahyork/PorousMaterials.jl/blob/edd63400959661cc89ea934fcf927e89007066a7/src/Misc.jl#L87-L95">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PorousMaterials.write_to_xyz" href="#PorousMaterials.write_to_xyz"><code>PorousMaterials.write_to_xyz</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">write_to_xyz(atoms, x, filename; comment=&quot;&quot;)
write_to_xyz(molecules, box, filename; comment=&quot;&quot;)
write_to_xyz(framework, filename; comment=&quot;&quot;)</code></pre><p>Write a molecule, framework, or array of atoms &amp; positions to an .xyz file.</p><p><strong>Arguments</strong></p><ul><li><p><code>atoms::Array{Symbol, 1}</code>: An array of atoms stored as symbols e.g. [:H, :H, :O]</p></li><li><p><code>x::Array{Float64, 2}</code>: The Cartesian coordinates of the atoms.</p></li></ul><p><code>x[:, k]</code> contains Cartesian coordinates of the k-th atom</p><ul><li><p><code>molecules::Array{Molecule, 1}</code>: an array of molecules whose atoms to write to .xyz</p></li><li><p><code>framework::Framework</code>: a crystal structure whose atoms to write to .xyz</p></li><li><p><code>filename::AbstractString</code>: The filename of the .xyz file. (&quot;.xyz&quot; appended automatically</p></li></ul><p>if the extension is not provided.) (absolute path)</p><ul><li><p><code>comment::AbstractString</code>: comment if you&#39;d like to write to the file.</p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/ahyork/PorousMaterials.jl/blob/edd63400959661cc89ea934fcf927e89007066a7/src/Misc.jl#L35-L51">source</a></section><p>##Molecules.jl</p><pre><code class="language-none">    translate_to!
    rotate!
    rotation_matrix
    rand_point_on_unit_sphere
    charged(::Molecule, ::Bool)</code></pre><p>##NearestImage.jl</p><pre><code class="language-none">    nearest_image!
    nearest_r²
    nearest_r</code></pre><p>##VdWEnergetics.jl</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PorousMaterials.lennard_jones" href="#PorousMaterials.lennard_jones"><code>PorousMaterials.lennard_jones</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">energy = lennard_jones(r², σ², ϵ)  (units: Kelvin)</code></pre><p>Calculate the lennard jones potential energy given the square of the radius r between two lennard-jones spheres. σ and ϵ are specific to interaction between two elements. Return the potential energy in units Kelvin (well, whatever the units of ϵ are).</p><p><strong>Arguments</strong></p><ul><li><p><code>r²::Float64</code>: distance between two (pseudo)atoms in question squared (Angstrom²)</p></li><li><p><code>σ²::Float64</code>: sigma parameter in Lennard Jones potential squared (units: Angstrom²)</p></li><li><p><code>ϵ::Float64</code>: epsilon parameter in Lennard Jones potential (units: Kelvin)</p></li></ul><p><strong>Returns</strong></p><ul><li><p><code>energy::Float64</code>: Lennard Jones potential energy</p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/ahyork/PorousMaterials.jl/blob/edd63400959661cc89ea934fcf927e89007066a7/src/VdWEnergetics.jl#L4-L18">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PorousMaterials.vdw_energy" href="#PorousMaterials.vdw_energy"><code>PorousMaterials.vdw_energy</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">energy = vdw_energy(framework, molecule, ljforcefield)</code></pre><p>Calculates the van der Waals interaction energy between a molecule and a framework. Applies the nearest image convention to find the closest replicate of a specific atom.</p><p>WARNING: it is assumed that the framework is replicated sufficiently such that the nearest image convention can be applied. See <a href="functions.html#PorousMaterials.replicate"><code>replicate</code></a>.</p><p><strong>Arguments</strong></p><ul><li><p><code>framework::Framework</code>: Crystal structure</p></li><li><p><code>molecule::Molecule</code>: adsorbate (includes position/orientation/atoms)</p></li><li><p><code>ljforcefield::LJForceField</code>: Lennard Jones force field</p></li></ul><p><strong>Returns</strong></p><ul><li><p><code>energy::Float64</code>: Van der Waals interaction energy</p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/ahyork/PorousMaterials.jl/blob/edd63400959661cc89ea934fcf927e89007066a7/src/VdWEnergetics.jl#L36-L52">source</a><div><pre><code class="language-none">gg_energy = vdw_energy(molecule_id, molecules, ljforcefield, simulation_box)</code></pre><p>Calculates van der Waals interaction energy of a single adsorbate <code>molecules[molecule_id]</code> with all of the other molecules in the system. Periodic boundary conditions are applied, using the nearest image convention.</p><p><strong>Arguments</strong></p><ul><li><p><code>molecule_id::Int</code>: Molecule ID used to determine which molecule in <code>molecules</code> we wish to calculate the guest-guest interactions</p></li><li><p><code>molecules::Array{Molecule, 1}</code>: An array of Molecule data structures</p></li><li><p><code>ljforcefield::LJForceField</code>: A Lennard Jones forcefield data structure describing the interactions between different atoms</p></li><li><p><code>simulation_box::Box</code>: The simulation box for the computation.</p></li></ul><p><strong>Returns</strong></p><ul><li><p><code>gg_energy::Float64</code>: The guest-guest interaction energy of <code>molecules[molecule_id]</code> with the other molecules in <code>molecules</code></p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/ahyork/PorousMaterials.jl/blob/edd63400959661cc89ea934fcf927e89007066a7/src/VdWEnergetics.jl#L63-L78">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PorousMaterials.vdw_energy_no_PBC" href="#PorousMaterials.vdw_energy_no_PBC"><code>PorousMaterials.vdw_energy_no_PBC</code></a> — <span class="docstring-category">Function</span>.</div><div><p>Assumes unit cell box is a unit cube and no periodic boundary conditions are applied.</p></div><a class="source-link" target="_blank" href="https://github.com/ahyork/PorousMaterials.jl/blob/edd63400959661cc89ea934fcf927e89007066a7/src/VdWEnergetics.jl#L135-L138">source</a></section><footer><hr/><a class="previous" href="index.html"><span class="direction">Previous</span><span class="title">Home</span></a></footer></article></body></html>
